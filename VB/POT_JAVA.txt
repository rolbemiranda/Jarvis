import java.io.File;
import java.io.InputStream;
import org.docx4j.dml.wordprocessingDrawing.Inline;
import org.docx4j.openpackaging.packages.WordprocessingMLPackage;
import org.docx4j.openpackaging.parts.WordprocessingML.BinaryPartAbstractImage;


 Creates a WordprocessingML document from scratch.

 @author Jason Harrop
 @version 1.0

public class POT {

public static void main(String[] args) throws Exception 
{
	WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.createPackage();
	File file = new File(Ctmpscreenshot.png );


	InputStream is = new java.io.FileInputStream(file );
	long length = file.length();   

	if (length  Integer.MAX_VALUE) {
		System.out.println(File too large!!);
	}

	byte[] bytes = new byte[(int)length];
	int offset = 0;
	int numRead = 0;
	while (offset  bytes.length
			&& (numRead=is.read(bytes, offset, bytes.length-offset)) = 0) {
		offset += numRead;
	}
	
	 Ensure all the bytes have been read in
	if (offset  bytes.length) {
		System.out.println(Could not completely read file +file.getName());
	}
	is.close();

	String filenameHint = null;
	String altText = null;
    int id1 = 0;
    int id2 = 1;
	                       
	org.docx4j.wml.P p3 = newImage( wordMLPackage, bytes, filenameHint, altText, id1, id2, 6000 );
      
     Now add our p to the document
     wordMLPackage.getMainDocumentPart().addObject(p3);
	              
	change user dir to results - change file name
	wordMLPackage.save(new java.io.File(Global.ScreenshotFileName));
}    
	       
	public static org.docx4j.wml.P newImage( WordprocessingMLPackage wordMLPackage,byte[] bytes,
	                        String filenameHint, String altText, int id1, int id2, long cx) throws Exception 
	{
	        BinaryPartAbstractImage imagePart = BinaryPartAbstractImage.createImagePart(wordMLPackage, bytes);
	        Inline inline = imagePart.createImageInline( filenameHint, altText, 
	                        id1, id2, cx);
	       
	         Now add the inline in wpwrwdrawing
            org.docx4j.wml.ObjectFactory factory = new org.docx4j.wml.ObjectFactory();
            org.docx4j.wml.P  p = factory.createP();
            org.docx4j.wml.R  run = factory.createR();             
            p.getParagraphContent().add(run);       
            org.docx4j.wml.Drawing drawing = factory.createDrawing();               
            run.getRunContent().add(drawing);               
            drawing.getAnchorOrInline().add(inline);
            return p;
	               
	}       
}